# B站主页净化助手

## 🎯 项目简介

**B站主页净化助手**是一款基于Python开发的自动化工具，旨在帮助用户通过批量拉黑特定分区的主播，减少低质量或不符合个人偏好的直播内容出现在B站首页和视频详情页的推荐位置，从而优化个人浏览体验。

## ✨ 核心特性

- **多层过滤系统**：支持白名单保护和性别过滤规则
- **自动化批量操作**：一键完成拉黑任务，节省手动操作时间
- **二维码扫码登录**：无需手动获取cookies，安全便捷
- **配置文件管理**：所有设置通过配置文件管理，支持默认配置创建
- **跨平台支持**：支持Windows、macOS和Linux系统
- **优雅的错误处理**：完善的异常处理和友好的错误提示

## 🚀 快速开始

### 环境要求
- Python 3.6 或更高版本
- 已安装Bilibili手机APP（用于扫码登录）

### 安装依赖
```bash
pip install requests qrcode
```

### 运行工具
```bash
python bilibili_homepage_purifier.py
```

## ⚙️ 使用流程

### 首次运行流程
1. **自动创建配置文件**：首次运行会自动创建`config.json`配置文件
2. **编辑配置文件**：程序会自动打开配置文件，请按照说明填写
3. **二维码扫码登录**：使用Bilibili APP扫描二维码登录
4. **自动执行拉黑**：根据配置自动拉黑指定分区的主播

### 后续运行流程
1. **自动加载配置**：程序会自动加载已有的配置文件
2. **自动验证登录**：自动检查cookies有效性，如过期则重新登录
3. **自动执行任务**：根据配置执行拉黑任务

## 📋 配置文件说明

### 配置文件位置
程序会自动在项目目录下创建并管理以下配置文件：
- **config.json**：主配置文件，包含所有运行参数
- **bilibili_cookies.json**：登录凭证文件，自动生成和管理

### 配置文件结构
程序会自动创建并打开配置文件`config.json`，主要包含以下字段：

```json
{
  "target_url": "https://live.bilibili.com/p/eden/area-tags?areaId=530&parentAreaId=1",
  "white_list": ["主播A", "主播B"],
  "skip_sex": ["男"],
  "说明": {
    "target_url": "直播分区网址，必须包含areaId和parentAreaId参数",
    "white_list": "白名单用户名列表，这些用户不会被拉黑",
    "skip_sex": "跳过的性别列表，只能包含'男'、'女'、'保密'，这些性别的用户不会被拉黑"
  }
}
```

### 配置文件字段详解

#### target_url
指定要处理的直播分区URL，必须包含`areaId`和`parentAreaId`参数。

常用分区配置：
- **萌宅领域**：`https://live.bilibili.com/p/eden/area-tags?areaId=530&parentAreaId=1`
- **舞见分区**：`https://live.bilibili.com/p/eden/area-tags?areaId=207&parentAreaId=1`
- **颜值分区**：`https://live.bilibili.com/p/eden/area-tags?areaId=145&parentAreaId=1`
- **团播分区**：`https://live.bilibili.com/p/eden/area-tags?areaId=1013&parentAreaId=1`

#### white_list
白名单列表，包含您希望保护的主播用户名。这些主播不会被拉黑。

#### skip_sex
性别过滤列表，包含要跳过的性别。可选值：`"男"`、`"女"`、`"保密"`。

**注意**：
- 如果设置为空列表`[]`：不启用性别过滤，所有用户都会进行拉黑检查
- 如果设置为`["男"]`：跳过男性用户
- 如果设置为`["女"]`：跳过女性用户
- 如果设置为`["保密"]`：跳过未公开性别的用户

## 🔐 登录系统

### 扫码登录流程
1. 程序启动后，会自动检查是否已有有效的登录cookies
2. 如果没有有效cookies，会自动生成登录二维码
3. 使用Bilibili手机APP扫描二维码登录
4. 登录成功后，cookies会自动保存到`bilibili_cookies.json`文件
5. 下次运行时会自动使用保存的cookies，无需重新登录

### 登录安全说明
- ✅ **本地存储**：cookies仅保存在本地文件中
- ✅ **自动验证**：每次运行都会验证cookies有效性
- ✅ **可重复使用**：cookies有效期内无需重复登录
- ✅ **安全退出**：如需重新登录，删除`bilibili_cookies.json`文件即可

## 📊 运行流程

1. **初始化配置**：加载或创建配置文件
2. **扫码登录**：通过二维码登录B站账号
3. **获取认证**：自动获取API所需的wbi密钥和webid
4. **分区扫描**：遍历指定分区的所有直播间
5. **多层过滤**：依次检查白名单和性别过滤规则
6. **批量拉黑**：对符合条件的账号执行拉黑操作
7. **生成报告**：显示详细的处理统计

## 🎮 操作指南

### 配置修改
- **自动打开**：首次运行时，程序会自动打开配置文件编辑器
- **手动编辑**：可随时手动编辑项目目录下的`config.json`文件
- **即时生效**：修改配置后，下次运行立即生效

### 性别过滤逻辑
程序会根据`skip_sex`配置自动调整性别过滤逻辑：
- **启用过滤**：当`skip_sex`不为空时，会检查用户性别并跳过指定性别
- **禁用过滤**：当`skip_sex`为空列表时，会跳过性别检查，直接进行拉黑
- **多种性别**：可以同时设置多种性别进行过滤

### 运行控制
- **按任意键继续**：程序中所有等待用户输入的地方都支持按任意键继续
- **程序中断**：随时按`Ctrl+C`可以安全中断程序
- **错误处理**：程序具备完善的错误处理机制，会显示详细错误信息

## ⚠️ 重要提示

### 使用注意事项
- **遵守平台规则**：使用前请仔细阅读B站用户协议
- **合理使用**：请勿滥用工具进行恶意批量操作
- **效果说明**：拉黑仅影响您个人的账号推荐，不会影响他人
- **可逆操作**：所有拉黑操作都可以在B站设置中撤销

### 隐私与安全
- **本地运行**：所有操作都在本地完成，不会上传任何数据
- **cookies安全**：登录信息仅保存在本地，不会被共享
- **账号保护**：建议使用小号或备用账号进行操作

## ❓ 常见问题

### Q1：为什么需要使用Bilibili APP扫码登录？
A：扫码登录是最安全、最方便的登录方式，避免了手动获取cookies的复杂流程和安全隐患。

### Q2：登录信息会过期吗？
A：会的。B站的登录凭证有有效期，通常为30天左右。过期后程序会提示重新登录。

### Q3：可以同时在多台设备上使用吗？
A：不建议。虽然可以复制配置文件，但可能会导致登录状态冲突。建议每台设备单独配置。

### Q4：如何修改配置？
A：程序会自动打开配置文件，也可以手动编辑项目目录下的`config.json`文件。

### Q5：如何重新登录？
A：删除项目目录下的`bilibili_cookies.json`文件，下次运行时会提示重新登录。

### Q6：如何恢复被误拉黑的主播？
A：可以在B站的以下位置恢复：
- **网页端**：设置 → 安全隐私 → 黑名单管理
- **手机APP**：我的 → 设置 → 安全隐私 → 黑名单管理

### Q7：性别过滤怎么设置才有效？
A：
- 如果要跳过所有男性用户：`"skip_sex": ["男"]`
- 如果要跳过所有女性用户：`"skip_sex": ["女"]`
- 如果要跳过未公开性别的用户：`"skip_sex": ["保密"]`
- 如果要跳过多种性别：`"skip_sex": ["男", "保密"]`
- 如果禁用性别过滤：`"skip_sex": []`

### Q8：程序运行时出现错误怎么办？
A：程序具备完善的错误处理机制，会显示详细的错误信息。常见问题：
- **网络错误**：检查网络连接
- **登录过期**：重新扫码登录
- **配置错误**：检查`config.json`文件格式

## 🔧 故障排除

### 常见问题
1. **二维码显示异常**：确保已安装`qrcode`库：`pip install qrcode`
2. **配置文件无法打开**：请手动编辑项目目录下的`config.json`文件
3. **登录失败**：检查网络连接，确保能正常访问B站
4. **运行缓慢**：网络状况或B站API限制可能导致运行缓慢，请耐心等待

### 跨平台支持
- **Windows**：完全支持，包括按任意键继续功能
- **macOS**：完全支持，可自动打开配置文件
- **Linux**：完全支持，可自动打开配置文件

### 文件路径
- **配置文件**：`项目目录/config.json`
- **cookies文件**：`项目目录/bilibili_cookies.json`

## 📈 预期效果

使用本工具后，您可以期待：
- ✅ 主页推荐的直播内容更符合个人偏好
- ✅ 视频详情页的相关推荐更加精准
- ✅ 整体浏览体验得到个性化优化
- ✅ 个人账号的内容生态系统更加健康

## 🔄 维护建议

### 定期更新
1. **更新白名单**：每1-2个月更新一次白名单配置
2. **调整分区**：根据个人兴趣变化调整目标分区
3. **重新登录**：如果工具失效，可能是登录过期，需要重新扫码登录

### 文件管理
- **备份配置**：建议备份重要的配置文件和cookies文件
- **定期清理**：如果不再使用，可以删除相关配置文件


## 🤝 贡献指南

欢迎为项目做出贡献：
1. Fork本仓库
2. 创建功能分支
3. 提交代码更改
4. 发起Pull Request

## 📄 开源协议

本项目采用GPL 3.0开源协议，详情请查看项目根目录下的LICENSE文件。

## 🌟 使用建议

1. **首次使用**：建议先配置完整的白名单，再逐步调整
2. **分区选择**：根据个人情况选择最需要清理的分区
3. **定期运行**：建议每月运行1-2次以保持效果
4. **效果评估**：运行后观察首页推荐变化，调整配置
5. **性别过滤**：根据个人需求合理设置性别过滤规则

---

**技术让内容管理更加高效，请合理使用工具，共建良好的网络环境。**

*注：本工具仅为技术实现方案，使用前请确保符合B站平台规则。*
